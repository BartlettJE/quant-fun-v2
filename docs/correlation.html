<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 9 Correlation | Fundamentals of Quantitative Analysis</title>
<meta name="author" content="Emily Nordmann &amp; Phil McAleer">
<meta name="description" content="We have spent the chapters so far focusing on the basics of R and data wrangling. You may think that the tasks we ask you to do in R will get harder as this course progresses but that isn't true....">
<meta name="generator" content="bookdown 0.23 with bs4_book()">
<meta property="og:title" content="Chapter 9 Correlation | Fundamentals of Quantitative Analysis">
<meta property="og:type" content="book">
<meta property="og:url" content="https://psyteachr.github.io/quant-fun-v2/correlation.html">
<meta property="og:image" content="https://psyteachr.github.io/quant-fun-v2/images/logos/logo.png">
<meta property="og:description" content="We have spent the chapters so far focusing on the basics of R and data wrangling. You may think that the tasks we ask you to do in R will get harder as this course progresses but that isn't true....">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 9 Correlation | Fundamentals of Quantitative Analysis">
<meta name="twitter:description" content="We have spent the chapters so far focusing on the basics of R and data wrangling. You may think that the tasks we ask you to do in R will get harder as this course progresses but that isn't true....">
<meta name="twitter:image" content="https://psyteachr.github.io/quant-fun-v2/images/logos/logo.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.10/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-6NP3MF25W3"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-6NP3MF25W3');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="include/psyteachr.css">
<link rel="stylesheet" href="include/webex.css">
<link rel="stylesheet" href="include/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Fundamentals of Quantitative Analysis</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Overview</a></li>
<li><a class="" href="foreword.html">Foreword</a></li>
<li><a class="" href="programming-basics.html"><span class="header-section-number">1</span> Programming basics</a></li>
<li><a class="" href="intro-to-r.html"><span class="header-section-number">2</span> Intro to R</a></li>
<li><a class="" href="starting-with-data.html"><span class="header-section-number">3</span> Starting with data</a></li>
<li><a class="" href="data-wrangling-1.html"><span class="header-section-number">4</span> Data wrangling 1</a></li>
<li><a class="" href="data-wrangling-2.html"><span class="header-section-number">5</span> Data wrangling 2</a></li>
<li><a class="" href="data-wrangling-3.html"><span class="header-section-number">6</span> Data Wrangling 3</a></li>
<li><a class="" href="intro-to-data-viz.html"><span class="header-section-number">7</span> Intro to Data Viz</a></li>
<li><a class="" href="probability.html"><span class="header-section-number">8</span> Probability</a></li>
<li><a class="active" href="correlation.html"><span class="header-section-number">9</span> Correlation</a></li>
<li><a class="" href="t-tests.html"><span class="header-section-number">10</span> t-tests</a></li>
<li><a class="" href="power-and-error.html"><span class="header-section-number">11</span> Power and error</a></li>
<li><a class="" href="screening-data.html"><span class="header-section-number">12</span> Screening Data</a></li>
<li><a class="" href="visualisation.html"><span class="header-section-number">13</span> Visualisation</a></li>
<li><a class="" href="one-way-anova.html"><span class="header-section-number">14</span> One-way ANOVA</a></li>
<li><a class="" href="factorial-anova.html"><span class="header-section-number">15</span> Factorial ANOVA</a></li>
<li><a class="" href="regression.html"><span class="header-section-number">16</span> Regression</a></li>
<li><a class="" href="multiple-regression.html"><span class="header-section-number">17</span> Multiple regression</a></li>
<li class="book-part">Appendices</li>
<li><a class="" href="installing-r.html"><span class="header-section-number">A</span> Installing R</a></li>
<li><a class="" href="updating-packages.html"><span class="header-section-number">B</span> Updating packages</a></li>
<li><a class="" href="additional-resources.html"><span class="header-section-number">C</span> Additional Resources</a></li>
<li><a class="" href="citing-r-rstudio.html"><span class="header-section-number">D</span> Citing R and RStudio</a></li>
<li><a class="" href="symbols.html"><span class="header-section-number">E</span> Symbols</a></li>
<li><a class="" href="conventions.html"><span class="header-section-number">F</span> Conventions</a></li>
<li><a class="" href="license.html">License</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/PsyTeachR/quant-fun-v2">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="correlation" class="section level1" number="9">
<h1>
<span class="header-section-number">9</span> Correlation<a class="anchor" aria-label="anchor" href="#correlation"><i class="fas fa-link"></i></a>
</h1>
<p>We have spent the chapters so far focusing on the basics of R and data wrangling. You may think that the tasks we ask you to do in R will get harder as this course progresses but that isn't true. The hardest part of learning R is at the very beginning, trying to learn the new terminology, figuring out how to load in data and wrangle it into the format you need. It may feel like you are still struggling so it's worth reflecting on just how far you've come in a short time.</p>
<p>You can now:</p>
<ul>
<li>Understand what functions, arguments, objects, variables, and tibbles are<br>
</li>
<li>Read data into R<br>
</li>
<li>Tidy data into an appropriate format<br>
</li>
<li>Calculate a range of descriptive statistics</li>
<li>Create plots of data</li>
</ul>
<p>That's amazing! Now we're going to move on to performing a correlation and to create a plot to visualise the data.</p>
<div id="correlation-1" class="section level2" number="9.1">
<h2>
<span class="header-section-number">9.1</span> Correlation<a class="anchor" aria-label="anchor" href="#correlation-1"><i class="fas fa-link"></i></a>
</h2>
<p>As <a href="https://drive.google.com/file/d/0B1fyuTuvj3YoaFdUR3FZaXNuNXc/view">Miller and Haden (2013)</a> state at the start of Chapter 11, correlations are <strong>used to detect and quantify relationships among numerical variables</strong>. In short, you measure two variables and the correlation analysis tells you whether or not they are related in some manner - positively or negatively; one increases as the other increases; one decreases as the other increases; etc..</p>
<p>To actually carry out a correlation is very simple and we will show you that today in a little while. The harder part of correlations is really wrangling the data and interpreting what the results mean. You are going to run a few correlations in this chapter to give you good practice at running and interpreting the relationships between two variables.</p>
<p><strong>Note:</strong> When dealing with correlations you should always refer to relationships and not predictions. In a correlation, X does not predict Y, that is regression which you will cover in later in this course. In a correlation, all we can say is whether X and Y are related.</p>
</div>
<div id="corr-a1" class="section level2" number="9.2">
<h2>
<span class="header-section-number">9.2</span> Activity 1: Set-up<a class="anchor" aria-label="anchor" href="#corr-a1"><i class="fas fa-link"></i></a>
</h2>
<p>In this chapter we will use the examples in Miller and Haden (2013), Chapter 11, looking at the relationship between four variables: reading ability, intelligence (IQ), the number of minutes per week spent reading at home (Home); and the number of minutes per week spent watching TV at home (TV). You can see in this situation that it would be unethical to manipulate these variables so measuring them as they exist in the environment is most appropriate; hence the use of correlations.</p>
<ul>
<li>Open R Studio and set the working directory to your Correlation folder. Ensure the environment is clear.<br>
</li>
<li>Open a new R Markdown document and save it in your working directory. Call the file "Correlation".<br>
</li>
<li>Download <a href="MillerHadenData.csv" download>MillerHadenData.csv</a> and save it in your Correlation folder and/or upload to to the R server. Make sure that you do not change the file name at all.<br>
</li>
<li>If you're on the server, avoid a number of issues by restarting the session - click <code>Session</code> - <code>Restart R</code>
</li>
<li>Delete the default R Markdown welcome text and insert a new code chunk that loads the packages <code>car</code>, <code>correlation</code>, <code>report</code>, <code>psych</code>, and <code>tidyverse</code> (in that order) using the <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> function and loads the data into an object named <code>mh</code> using <code>read_csv()</code>. You may need to install some of these packages if you don't already have them.</li>
</ul>
</div>
<div id="corr-a2" class="section level2" number="9.3">
<h2>
<span class="header-section-number">9.3</span> Activity 2: Look at your data<a class="anchor" aria-label="anchor" href="#corr-a2"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>Look at your data, you can do this by clicking on the object in the environment, or using <code><a href="https://rdrr.io/r/base/summary.html">summary(mh)</a></code> or <code><a href="https://rdrr.io/r/utils/head.html">head(mh)</a></code>.</li>
</ul>
<p>As in Miller and Haden, we have 5 columns:</p>
<ol style="list-style-type: decimal">
<li>The participant (<code>Participant</code>),</li>
<li>Reading Ability score (<code>Abil</code>),</li>
<li>Intelligence score (<code>IQ</code>),</li>
<li>Number of minutes spent reading at home per week (<code>Home</code>),</li>
<li>And number of minutes spent watching TV per week (<code>TV</code>).</li>
</ol>
<p>For the chapter we will focus on Reading Ability and IQ but for further practice you can look at other relationships in your free time.</p>
<p>A probable hypothesis could be that as Reading Ability increases so does Intelligence (but think of the issue with causality and direction). Phrasing the hypothesis more formally, we hypothesise that the reading ability of school children, as measured through a standardized test, and intelligence, again measured through a standardized test, are positively correlated.</p>
</div>
<div id="corr-a3" class="section level2" number="9.4">
<h2>
<span class="header-section-number">9.4</span> Activity 3: Assumptions<a class="anchor" aria-label="anchor" href="#corr-a3"><i class="fas fa-link"></i></a>
</h2>
<p>First, however, we must check some assumptions of the correlation tests. The main assumptions we need to check are:</p>
<ol style="list-style-type: decimal">
<li>Is the data interval, ratio, or ordinal?</li>
<li>Is there a data point for each participant on both variables?</li>
<li>Is the data normally distributed in both variables?</li>
<li>Does the relationship between variables appear linear?</li>
<li>Does the spread have homoscedasticity?</li>
</ol>
<p>We will look at these in turn.</p>
<div id="assumption-1-level-of-measurement" class="section level3" number="9.4.1">
<h3>
<span class="header-section-number">9.4.1</span> Assumption 1: Level of Measurement<a class="anchor" aria-label="anchor" href="#assumption-1-level-of-measurement"><i class="fas fa-link"></i></a>
</h3>
<p>If we want to run a Pearson correlation then we need interval or ratio data; Spearman correlations can run with ordinal, interval or ratio data. What type of data do we have?</p>
<ul>
<li>The type of data in this analysis is most probably <select class="webex-select"><option value="blank"></option>
<option value="">ratio</option>
<option value="answer">interval</option>
<option value="">ordinal</option>
<option value="">nominal</option></select> as the data is <select class="webex-select"><option value="blank"></option>
<option value="answer">continuous</option>
<option value="">discrete</option></select> and there is unlikely to be a true zero</li>
</ul>
<div class="webex-solution">
<button>
Hints on data type
</button>
<ul>
<li>Are the variables continuous?</li>
<li>Is the difference between 1 and 2 on the scale equal to the difference between 2 and 3?</li>
</ul>
</div>
</div>
<div id="assumption-2-pairs-of-data" class="section level3" number="9.4.2">
<h3>
<span class="header-section-number">9.4.2</span> Assumption 2: Pairs of Data<a class="anchor" aria-label="anchor" href="#assumption-2-pairs-of-data"><i class="fas fa-link"></i></a>
</h3>
<p>All correlations must have a data point for each participant in the two variables being correlated. This should make sense as to why - you can't correlate against an empty cell! So now go check that you have a data point in both columns for each participant.</p>
<p>It looks like that everyone has data in all the columns but let's test our skills a little whilst we are here. Answer the following questions:</p>
<ol style="list-style-type: decimal">
<li>How is missing data represented in a tibble? <select class="webex-select"><option value="blank"></option>
<option value="">an empty cell</option>
<option value="answer">NA</option>
<option value="">a large number</option>
<option value="">don't know</option></select>
</li>
<li>Which code would leave you with just the participants who were missing Reading Ability data in mh:
<select class="webex-select"><option value="blank"></option>
<option value="">filter(mh, is.na(Ability)</option>
<option value="answer">filter(mh, is.na(Abil)</option>
<option value="">filter(mh, !is.na(Ability)</option>
<option value="">filter(mh, !is.na(Abil)</option></select>
</li>
<li>Which code would leave you with just the participants who were not missing Reading Ability data in mh: <select class="webex-select"><option value="blank"></option>
<option value="">filter(mh, is.na(Ability)</option>
<option value="">filter(mh, is.na(Abil)</option>
<option value="">filter(mh, !is.na(Ability)</option>
<option value="answer">filter(mh, !is.na(Abil)</option></select>
</li>
</ol>
<div class="webex-solution">
<button>
Hints on removing missing data points
</button>
<ul>
<li>
<code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter(dat, is.na(variable))</a></code> versus <code><a href="https://dplyr.tidyverse.org/reference/filter.html">filter(dat, !is.na(variable))</a></code>
</li>
</ul>
</div>
</div>
<div id="assumption-3-5-normality-linearity-homoscedasticity" class="section level3" number="9.4.3">
<h3>
<span class="header-section-number">9.4.3</span> Assumption 3-5: Normality, linearity, homoscedasticity<a class="anchor" aria-label="anchor" href="#assumption-3-5-normality-linearity-homoscedasticity"><i class="fas fa-link"></i></a>
</h3>
<p>The remaining assumptions are all best checked through visualisations. You can use histograms and QQ-plots to check that the data (<code>Abil</code> and <code>IQ</code>) are both normally distributed, and you can use a scatterplot of IQ as a function of Abil to check whether the relationship is linear, with homoscedasticity, and without outliers. There are various options and tests for assessing these assumptions but today we will just use visual checks.</p>
<ul>
<li>Run the below code to create a histogram for <code>Abil</code>.</li>
</ul>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">mh</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Abil</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:abil-hist"></span>
<img src="09-correlation_files/figure-html/abil-hist-1.png" alt="Histogram of Abil" width="100%"><p class="caption">
Figure 9.1: Histogram of Abil
</p>
</div>
<p>This code should look very similar to the code you used to create a bar plot in Intro to Data Viz. We have specified that we want to display <code>Abil</code> on the x-axis and that the shape we want to produce is a histogram, hence <code>geom_histogram()</code>. Just like <code>geom_bar()</code>, you do not need to specify the y-axis because if it's a histogram, it's always a count.</p>
<ul>
<li>Write and run the code to produce another histogram for the variable <code>IQ</code>.</li>
</ul>
<p>The QQ-plots require us to use the package <code>car</code> rather than <code>ggplot2</code>. You can make QQ-plots in <code>ggplot2</code> but they aren't as useful, however, the code is still very simple.</p>
<ul>
<li>Run the below code to create a QQ-plot for <code>Abil</code>.</li>
</ul>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">qqPlot</span><span class="op">(</span>x <span class="op">=</span> <span class="va">mh</span><span class="op">$</span><span class="va">Abil</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:qq-abil"></span>
<img src="09-correlation_files/figure-html/qq-abil-1.png" alt="QQ-plot for Abil" width="100%"><p class="caption">
Figure 9.2: QQ-plot for Abil
</p>
</div>
<pre><code>## [1] 15  4</code></pre>
<p>This code looks a little different to code you've used up until this point as it comes from Base R. It uses the notation <code>object$variable</code> so our x variable could be read as "use the variable <code>Abil</code> from the object <code>mh</code>.</p>
<p>The QQ-plot includes a <strong>confidence envelope</strong> (the blue dotted lines). The simple version is that if your data points fall within these dotted lines then you can assume normality. The <code>ggplot2</code> version of QQ-plots make it more difficult to add on this confidence envelope, which is why we're using a different package. <code><a href="https://rdrr.io/pkg/car/man/qqPlot.html">qqPlot()</a></code> will also print the IDs of the most extreme data points. In this case, the 4th and 15th data point in <code>Abil</code> are flagged, although because they fall within the confidence envelope, they don't appear problematic.</p>
<ul>
<li>Write and run the code to create a QQ-plot for <code>IQ</code>.</li>
</ul>
<p>In order to assess linearity and homoscedasticity, we can create a scatterplot using <code>ggplot2</code>.</p>
</div>
</div>
<div id="correlation-scatterplot" class="section level2" number="9.5">
<h2>
<span class="header-section-number">9.5</span> Correlation Scatterplot<a class="anchor" aria-label="anchor" href="#correlation-scatterplot"><i class="fas fa-link"></i></a>
</h2>
<p>The <code>ggplot2</code> code is very similar to what you have already encountered with the bar chart and violin-boxplot. The first line of data sets up the base of the plot and we specify that we wish to display <code>Abil</code> on the x-axis, <code>IQ</code> on the y-axis, and use the dataset <code>mh</code>.</p>
<p>The first geom, <code>geom_point()</code> adds in the data points, the second geom, <code>geom_smooth</code> adds in the line of best fit. The shaded area around the line is a <strong>confidence interval</strong>.</p>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">mh</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Abil</span>, y <span class="op">=</span> <span class="va">IQ</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span><span class="op">)</span> <span class="co"># if you don't want the shaded CI, add se = FALSE to this</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula 'y ~ x'</code></pre>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="09-correlation_files/figure-html/unnamed-chunk-4-1.png" alt="Scatterplot of scores" width="100%"><p class="caption">
Figure 4.3: Scatterplot of scores
</p>
</div>
<ul>
<li>Remember that <code>ggplot2</code> works on layers and that you customise each layer. Edit the above code to add in layer of <code>scale_x_continuous()</code> that changes the label <code>Abil</code> to <code>Reading Ability</code>.</li>
</ul>
<p>Based on the above visualisations:</p>
<ul>
<li>Is the assumption of normality met for both variables? <select class="webex-select"><option value="blank"></option>
<option value="answer">Yes</option>
<option value="">No</option></select>
</li>
<li>Is the assumption of linearity met for both variables? <select class="webex-select"><option value="blank"></option>
<option value="answer">Yes</option>
<option value="">No</option></select>
</li>
<li>Is the assumption of homoscedasticity met for both variables? <select class="webex-select"><option value="blank"></option>
<option value="answer">Yes</option>
<option value="">No</option></select>
</li>
</ul>
<div class="webex-solution">
<button>
Explain these answers
</button>
<p>When assessing assumptions through the use of visualisations your decision will always be a judgement call. In this dataset, we only have data from 25 participants therefore it is very unlikely we would ever observe perfect normality and linearity in this dataset. It is likely that a researcher would assume that this data is approximately normal, that there is no evidence of a non-linear relationship, and that the spread of data points around the line is relatively even.</p>
<p>Many students become fixated with needing a 'perfect' dataset that follows an exactly normal distribution. This is unlikely to ever happen with real data - learn to trust your instincts!</p>
</div>
<p><br></p>
<p>Look at the scatterplot and think back to the lecture, how would you describe this correlation in terms of direction and strength?</p>
</div>
<div id="corr-a4" class="section level2" number="9.6">
<h2>
<span class="header-section-number">9.6</span> Activity 4: Descriptive statistics<a class="anchor" aria-label="anchor" href="#corr-a4"><i class="fas fa-link"></i></a>
</h2>
<p>Many researchers (and indeed members of the School of Psychology!) disagree as to whether you need to report descriptive statistics such as the mean and SD for a correlation. The argument against reporting them is that the scatterplot is actually the descriptive of the correlation that you would use to describe the potential relationship in regards to your hypothesis.</p>
<p>The counter argument is that providing descriptive statistics can still be informative about the spread of data for each variable, for example, in the current example it would make it easier to understand whether the participants as a whole compare to the population IQ score.</p>
<p>There's no fixed answer to this question but the person writing this book takes the second view that you should always report descriptive statistics so that's what we're going to do.</p>
<ul>
<li>Calculate the mean score and standard deviation for <code>Abil</code> and <code>IQ</code> using <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code>
</li>
<li>Name the output of the calculations <code>Abil_mean</code>, <code>Abil_SD</code>, <code>IQ_mean</code>, and <code>IQ_SD</code>. Make sure to use these exact spellings otherwise later activities won't work.</li>
<li>Store the output of this in an object called <code>descriptives</code> and then view the object. It should look something like this:</li>
</ul>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="center">Abil_mean</th>
<th align="center">Abil_SD</th>
<th align="center">IQ_mean</th>
<th align="center">IQ_SD</th>
</tr></thead>
<tbody><tr class="odd">
<td align="center">55.12</td>
<td align="center">6.08</td>
<td align="center">100.04</td>
<td align="center">9.04</td>
</tr></tbody>
</table></div>
</div>
<div id="corr-a5" class="section level2" number="9.7">
<h2>
<span class="header-section-number">9.7</span> Activity 5: Run the correlation<a class="anchor" aria-label="anchor" href="#corr-a5"><i class="fas fa-link"></i></a>
</h2>
<p>Finally we will run the correlation. There are often many different functions that can be used to achieve the same thing in R, and we're actually going to show you two ways of running a correlation.</p>
<p>First, we'll use the <code><a href="https://easystats.github.io/correlation/reference/correlation.html">correlation()</a></code> function from the <code>correlation</code> package. Remember that for help on any function you can type e.g., <code><a href="https://easystats.github.io/correlation/reference/correlation.html">?correlation</a></code> in the console window. The <code><a href="https://easystats.github.io/correlation/reference/correlation.html">correlation()</a></code> function requires:</p>
<ul>
<li>The name of the data set you are using</li>
<li>The name of the first variable you want to select for the correlation</li>
<li>The name of the second variable you want to select for the correlation</li>
<li>The type of correlation you want to run: e.g. <code>pearson</code>, <code>spearman</code>
</li>
<li>The type of NHST tail you want to run: e.g. <code>"less"</code>,<code>"greater"</code>, <code>"two.sided"</code>
</li>
</ul>
<p>For example, if your data is stored in <code>dat</code> and you want to do a two-sided pearson correlation of the variables (columns) <code>X</code> and <code>Y</code>, then you would do:</p>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">correlation</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dat</span>, select <span class="op">=</span> <span class="st">"X"</span>, select2 <span class="op">=</span> <span class="st">"Y"</span>,  method <span class="op">=</span> <span class="st">"pearson"</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span></code></pre></div>
<ul>
<li>Based on your answers to the assumption tests, decide which correlation method to use (e.g. pearson or spearman) and the type of NHST tail to set (e.g. two.sided or one.sided).</li>
<li>Run the correlation between IQ and Ability and save it in an object called <code>results</code>.</li>
<li>View the output by typing <code><a href="https://rdrr.io/r/utils/View.html">View(results)</a></code> in the console</li>
</ul>
<p>The second method is to use <code><a href="https://rdrr.io/r/stats/cor.test.html">cor.test()</a></code> which is a Base R function and uses similar code as <code><a href="https://easystats.github.io/correlation/reference/correlation.html">correlation()</a></code> except for how the variables are specified. <code><a href="https://rdrr.io/r/stats/cor.test.html">cor.test()</a></code> use formula syntax in the form <code>~ x + y</code> where x and y are the two variables you wish to correlate.</p>
<ul>
<li>Run the below code and then view the output by typing <code>results2</code> in the console. Look at how the output differs from <code>results</code>.</li>
</ul>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">results2</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="op">~</span> <span class="va">IQ</span> <span class="op">+</span> <span class="va">Abil</span>, data <span class="op">=</span> <span class="va">mh</span>,  method <span class="op">=</span> <span class="st">"pearson"</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span></code></pre></div>
<p>We'll come back to why we've shown you two ways shortly.</p>
</div>
<div id="corr-a6" class="section level2" number="9.8">
<h2>
<span class="header-section-number">9.8</span> Activity 6: Interpreting the correlation<a class="anchor" aria-label="anchor" href="#corr-a6"><i class="fas fa-link"></i></a>
</h2>
<p>You should now have a tibble called <code>results</code> that gives you the output of the correlation between Reading Ability and IQ for the school children measured in Miller and Haden (2013) Chapter 11. All that is left to do now, is interpret the output.</p>
<p>Look at <code>results</code>and then answer the following questions:</p>
<ol style="list-style-type: decimal">
<li>What is the value of Pearson's <em>r</em> to 2 decimal places? <input class="webex-solveme nospaces" size="20" data-answer='[".45","0.45"]'>
</li>
<li>The direction of the relationship between Ability and IQ is: <select class="webex-select"><option value="blank"></option>
<option value="answer">positive</option>
<option value="">negative</option>
<option value="">no relationship</option></select>
</li>
<li>The strength of the relationship between Ability and IQ is: <select class="webex-select"><option value="blank"></option>
<option value="">strong</option>
<option value="answer">medium</option>
<option value="">weak</option></select>
</li>
<li>Based on <span class="math inline">\(\alpha = .05\)</span> the relationship between Ability and IQ is: <select class="webex-select"><option value="blank"></option>
<option value="answer">significant</option>
<option value="">not significant</option></select>
</li>
<li>The hypothesis was that the reading ability of school children, as measured through a standardized test, and intelligence, again through a standardized test, are positively correlated. Based on the results we can say that the hypothesis: <select class="webex-select"><option value="blank"></option>
<option value="answer">is supported</option>
<option value="">is not supported</option>
<option value="">is proven</option>
<option value="">is not proven</option></select>
</li>
</ol>
<div class="webex-solution">
<button>
Explain these answers
</button>
<ol style="list-style-type: decimal">
<li>The test statistic, in this case the r value, is usually labelled as the <code>estimate</code>.</li>
<li>If Y increases as X increases then the relationship is positive. If Y increases as X decreases then the relationship is negative. If there is no change in Y as X changes then there is no relationship</li>
<li>Depending on the field most correlation values greater than .5 would be strong; .3 to .5 as medium, and .1 to .3 as small.</li>
<li>The field standard says less than .05 is significant and our p-value is less than .05.</li>
<li>Hypotheses can only be supported or not supported, never proven. In this case, our results matched our hypothesis therefore it is supported.</li>
</ol>
</div>
</div>
<div id="corr-a7" class="section level2" number="9.9">
<h2>
<span class="header-section-number">9.9</span> Activity 7: Write-up<a class="anchor" aria-label="anchor" href="#corr-a7"><i class="fas fa-link"></i></a>
</h2>
<p>Copy and paste the below <strong>exactly</strong> into <strong>white space</strong> in your R Markdown document and then knit the file.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="correlation.html#cb123-1" aria-hidden="true" tabindex="-1"></a>The mean IQ score was <span class="st">`</span><span class="at">r round(pluck(descriptives$IQ_mean),2)</span><span class="st">`</span> (<span class="st">`</span><span class="at">r round(pluck(descriptives$IQ_SD),2)</span><span class="st">`</span>) and the mean reading ability score was <span class="st">`</span><span class="at">r round(pluck(descriptives$Abil_mean),2)</span><span class="st">`</span> (<span class="st">`</span><span class="at">r round(pluck(descriptives$Abil_SD),2)</span><span class="st">`</span>). A Pearson\<span class="st">`</span><span class="at">s correlation found a significant, medium positive correlation between the two variables (r (</span><span class="st">`</span>r results<span class="sc">$</span>df_error<span class="st">`</span><span class="at">) = </span><span class="st">`</span>r <span class="fu">round</span>(results<span class="sc">$</span>r, <span class="dv">2</span>)<span class="st">`</span><span class="at">, *p* = </span><span class="st">`</span>r <span class="fu">round</span>(results<span class="sc">$</span>p, <span class="dv">3</span>)<span class="st">`</span><span class="at">).</span></span></code></pre></div>
<p>It will magically transform into:</p>
<blockquote>
<p>The mean IQ score was 100.04(9.04) and the mean reading ability score was 55.12(6.08). A Pearson`s correlation found a significant, medium positive correlation between the two variables (r (23) = 0.45, <em>p</em> = 0.024)</p>
</blockquote>
<p>The reason that we have shown you two methods of performing correlations is because of the way each outputs the results. <code><a href="https://easystats.github.io/correlation/reference/correlation.html">correlation()</a></code> produces a tibble which means it is very easy to work with and pull out values or join to another table as needed because it is already in tidyverse format.</p>
<p><code><a href="https://rdrr.io/r/stats/cor.test.html">cor.test()</a></code> on the other hand produces a <code>list</code> type object, which is a bit harder to work with. However, the output of <code><a href="https://rdrr.io/r/stats/cor.test.html">cor.test()</a></code> also happens to work with functions from the <code>report</code> package, <code><a href="https://easystats.github.io/report/reference/report.html">report()</a></code> and <code><a href="https://easystats.github.io/report/reference/report_table.html">report_table()</a></code> that automatically reports the results of statistical analyses for you.</p>
<p><code><a href="https://easystats.github.io/report/reference/report.html">report()</a></code> presents a fixed write-up of the correlation with all the available information. For correlations, this is perhaps less than useful, however, for more complex statistics this reporting function can really help and so we're introducing it now.</p>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">report</span><span class="op">(</span><span class="va">results2</span><span class="op">)</span></code></pre></div>
<pre><code>## Effect sizes were labelled following Funder's (2019) recommendations.
## 
## The Pearson's product-moment correlation between IQ and Abil is positive, statistically significant, and very large (r = 0.45, 95% CI [0.07, 0.72], t(23) = 2.42, p = 0.024)</code></pre>
<p><code><a href="https://easystats.github.io/report/reference/report.html">report()</a></code> doesn't currently work with the output of <code><a href="https://easystats.github.io/correlation/reference/correlation.html">correlation()</a></code> which is why we showed you both ways.</p>
</div>
<div id="corr-a8" class="section level2" number="9.10">
<h2>
<span class="header-section-number">9.10</span> Activity 8: Scatterplot matrix<a class="anchor" aria-label="anchor" href="#corr-a8"><i class="fas fa-link"></i></a>
</h2>
<p>Above we ran one correlation. However, when you have lots of variables in a dataset, to get a quick overview of patterns, you might want to run all the correlations at the same time or create a matrix of scatterplots at the one time. You can do this with functions from the <code>psych</code> and <code>correlation</code> packages (<code><a href="https://rdrr.io/r/stats/cor.test.html">cor.test()</a></code> only works for one correlation at a time). We will use the Miller and Haden data here again which you should still have in a tibble called <code>mh</code>.</p>
<ul>
<li>Run the following code The <code>pairs.panels())</code> function from the <code>psych</code> library creates a matrix of scatterplots, with the histograms, and correlation coefficients which you can then use to give you an overview of all the relationships at the one time.</li>
</ul>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pairs.panels</span><span class="op">(</span><span class="va">mh</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:pairs"></span>
<img src="09-correlation_files/figure-html/pairs-1.png" alt="Scatterplot matrix" width="100%"><p class="caption">
Figure 9.3: Scatterplot matrix
</p>
</div>
<p>Notice something wrong? <code><a href="https://rdrr.io/pkg/psych/man/pairs.panels.html">pairs.panels()</a></code> will create plots for <strong>all</strong> variables in your data (as will <code><a href="https://easystats.github.io/correlation/reference/correlation.html">correlation()</a></code> below). This means that it has correlated the Participant ID number as well, which is totally meaningless.</p>
<p>Instead, we can use pipes to help us out here. This code:</p>
<ul>
<li>Takes the dataset <code>mh</code> and then;</li>
<li>Uses <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> to drop the <code>Participant</code> column and then;</li>
<li>Pipes this adjusted data into the <code><a href="https://rdrr.io/pkg/psych/man/pairs.panels.html">pairs.panels()</a></code> function</li>
<li>The additional arguments turn off the <a href="https://analyse-it.com/docs/user-guide/multivariate/scatter-plot#:~:text=If%20the%20association%20is%20a,more%20the%20variables%20are%20uncorrelated.">correlation ellipses</a>, use a linear line of best fit, and specify a Pearson's correlation.</li>
</ul>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mh</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Participant</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">pairs.panels</span><span class="op">(</span>ellipses <span class="op">=</span> <span class="cn">F</span>, lm <span class="op">=</span> <span class="cn">TRUE</span>, method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:pairs-pipes"></span>
<img src="09-correlation_files/figure-html/pairs-pipes-1.png" alt="Adjusted scatterplot matrix" width="100%"><p class="caption">
Figure 9.4: Adjusted scatterplot matrix
</p>
</div>
<p>There are additional arguments to adjust the plot <code>pairs.panel</code> creates that you can look up in the help documentation if you are interested.</p>
</div>
<div id="corr-a9" class="section level2" number="9.11">
<h2>
<span class="header-section-number">9.11</span> Activity 9: Multiple correlations<a class="anchor" aria-label="anchor" href="#corr-a9"><i class="fas fa-link"></i></a>
</h2>
<p>To perform multiple correlations in one go, we will again use the <code><a href="https://easystats.github.io/correlation/reference/correlation.html">correlation()</a></code> function. package. Rather than specifying two variables to correlation, you can also provide a data frame that has multiple variables and it will run all possible correlations between the variables. Similar to above, we want to remove the <code>Participant</code> column before we do this.</p>
<ul>
<li><p><code>method</code> controls which correlation is computed, the default is <code>pearson</code> but if you needed to run the non-parametric version you could change this to <code>spearman</code>.<br></p></li>
<li><p><code>p_adjust</code> is the reason we are using the <code>correlation</code> package. In the lectures we discussed the problem of multiple comparisons - the idea that if you run lots and lots of tests you're likely to produce a significant p-value just by chance. This argument applies a correction to the p-value that adjusts for the number of correlations you have performed. There are several different methods which you can look up in the help documentation, the default setting is a Bonferroni-Holm correction.<br></p></li>
<li><p>Because you're running multiple correlations and some may be positive and some may be negative, there is no option to specify a one or two-tailed test.</p></li>
<li><p>Run the below code to calculate then view the correlation results</p></li>
</ul>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">corr_results</span> <span class="op">&lt;-</span> <span class="va">mh</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Participant</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">correlation</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"pearson"</span>, p_adjust <span class="op">=</span> <span class="st">"holm"</span><span class="op">)</span>

<span class="va">corr_results</span></code></pre></div>
<p><code>corr_results</code> is a tibble that lists the results of each correlation with its corresponding statistics. Look through the table and then answer the following questions:</p>
<ol style="list-style-type: decimal">
<li>Is the correlation between <code>Abil</code> and <code>Home</code> positive or negative? <select class="webex-select"><option value="blank"></option>
<option value="answer">Positive</option>
<option value="">Negative</option></select>
</li>
<li>This means that as <code>Abil</code> scores increase, <code>Home</code> scores will <select class="webex-select"><option value="blank"></option>
<option value="answer">Increase</option>
<option value="">Decrease</option></select>
</li>
<li>What is the strongest positive correlation? <select class="webex-select"><option value="blank"></option>
<option value="">Abil * IQ</option>
<option value="answer">Abil * Home</option>
<option value="">Abil * TV</option></select>
</li>
<li>What is the strongest negative correlation? <select class="webex-select"><option value="blank"></option>
<option value="">Abil * TV</option>
<option value="">IQ * TV</option>
<option value="answer">Home * TV</option></select>
</li>
<li>Is the correlation between <code>Abil</code> and <code>IQ</code> significant? <select class="webex-select"><option value="blank"></option>
<option value="">Yes</option>
<option value="answer">No</option></select>
</li>
<li>Is the correlation between <code>Abil</code> and <code>Home</code> significant? <select class="webex-select"><option value="blank"></option>
<option value="answer">Yes</option>
<option value="">No</option></select>
</li>
<li>How would you describe the strength of the correlation between <code>Home</code> and <code>TV</code>? <select class="webex-select"><option value="blank"></option>
<option value="">Weak</option>
<option value="">Medium</option>
<option value="answer">Strong</option></select>
</li>
<li>Think back to the lecture. Why are we not calculating an effect size?</li>
</ol>
<div class="webex-solution">
<button>
Explain these answers
</button>
<ol style="list-style-type: decimal">
<li>Negative correlations are denoted by a negative r value.
<ol start="2" style="list-style-type: decimal">
<li>Positive correlations = as one score goes up so does the other, negative correlations = as one score goes up the other goes down.<br>
3 &amp; 4. Remember that correlations take values from -1 - 1 and that the nearer to one in either direction the stronger the correlation (i.e., an r value of 0 would demonstrate a lack of any relationship.<br>
5 &amp; 6. The traditional cut-off for significance is .05. Anything below .05 is considered significant. Be careful to pay attention to decimal places.<br>
</li>
<li>Cohen's guidelines recommend weak = 1. - .3, medium = .3 - .5, strong &gt; .5.<br>
</li>
<li>Because r is an effect size.</li>
</ol>
</li>
</ol>
</div>
<p><br></p>
</div>
<div id="corr-fin" class="section level2" number="9.12">
<h2>
<span class="header-section-number">9.12</span> Finished!<a class="anchor" aria-label="anchor" href="#corr-fin"><i class="fas fa-link"></i></a>
</h2>
<p>Well done! You can now add correlations to the list of things you can do in R. If you have any questions, please post them on Teams.</p>
</div>
<div id="corr-sols" class="section level2" number="9.13">
<h2>
<span class="header-section-number">9.13</span> Activity solutions<a class="anchor" aria-label="anchor" href="#corr-sols"><i class="fas fa-link"></i></a>
</h2>
<div id="corr-a1sol" class="section level3" number="9.13.1">
<h3>
<span class="header-section-number">9.13.1</span> Activity 1<a class="anchor" aria-label="anchor" href="#corr-a1sol"><i class="fas fa-link"></i></a>
</h3>
<div class="webex-solution">
<button>
Activity 1
</button>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://r-forge.r-project.org/projects/car/">"car"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://easystats.github.io/correlation/">"correlation"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://easystats.github.io/report/">"report"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://personality-project.org/r/psych/">"psych"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyverse.tidyverse.org">"tidyverse"</a></span><span class="op">)</span>
<span class="va">mh</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"MillerHadenData.csv"</span><span class="op">)</span></code></pre></div>
</div>
<p><strong>click the tab to see the solution</strong>
<br></p>
</div>
<div id="corr-a3sol" class="section level3" number="9.13.2">
<h3>
<span class="header-section-number">9.13.2</span> Activity 3<a class="anchor" aria-label="anchor" href="#corr-a3sol"><i class="fas fa-link"></i></a>
</h3>
<div class="webex-solution">
<button>
Activity 3
</button>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># histogram</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">mh</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">IQ</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span>

<span class="co"># qqplot</span>
<span class="fu"><a href="https://rdrr.io/pkg/car/man/qqPlot.html">qqPlot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mh</span><span class="op">$</span><span class="va">IQ</span><span class="op">)</span>

<span class="co"># edited scatterplot</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">mh</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Abil</span>, y <span class="op">=</span> <span class="va">IQ</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_smooth</span><span class="op">(</span>method <span class="op">=</span> <span class="va">lm</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Reading Ability"</span><span class="op">)</span></code></pre></div>
</div>
<p><strong>click the tab to see the solution</strong>
<br></p>
</div>
<div id="corr-a4sol" class="section level3" number="9.13.3">
<h3>
<span class="header-section-number">9.13.3</span> Activity 4<a class="anchor" aria-label="anchor" href="#corr-a4sol"><i class="fas fa-link"></i></a>
</h3>
<div class="webex-solution">
<button>
Activity 4
</button>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">descriptives</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="va">mh</span>, 
                          Abil_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Abil</span><span class="op">)</span>,
                          Abil_SD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Abil</span><span class="op">)</span>,
                          IQ_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">IQ</span><span class="op">)</span>,
                          IQ_SD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">IQ</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<p><strong>click the tab to see the solution</strong>
<br></p>
</div>
<div id="corr-a5sol" class="section level3" number="9.13.4">
<h3>
<span class="header-section-number">9.13.4</span> Activity 5<a class="anchor" aria-label="anchor" href="#corr-a5sol"><i class="fas fa-link"></i></a>
</h3>
<div class="webex-solution">
<button>
Activity 5
</button>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://easystats.github.io/correlation/reference/correlation.html">correlation</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mh</span>, select <span class="op">=</span> <span class="st">"IQ"</span>, select2 <span class="op">=</span> <span class="st">"Abil"</span>,  method <span class="op">=</span> <span class="st">"pearson"</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span></code></pre></div>
</div>
<p><strong>click the tab to see the solution</strong>
<br></p>

</div>
</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script><script>
$( document ).ready(function() {
  var cite = ' ';
  var psyteachr = ' <a href="https://psyteachr.github.io/"><img src="images/logos/psyteachr_logo.png" style="height: 31px; color: white;" alt="psyTeachR: Reproducible Research" /></a>';
  var license = ' <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" target="blank"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a>';

  $("footer div.row div:eq(1) p").html(
    psyteachr + license + cite
  );
  
  // open rdrr links externally
  $("a[href^='https://rdrr.io']").click(function(){
    window.open(this.href);
    return false;
  });
  
  // visible second sidebar in mobile
  function move_sidebar() {
    var w = window.innerWidth;
    if (w < 992) {
      $("#toc").appendTo($("#main-nav"));
    } else {
      $("#toc").appendTo($("div.sidebar-chapter"));
    }
  }
  move_sidebar();
  window.onresize = move_sidebar;
});
</script><div class="chapter-nav">
<div class="prev"><a href="probability.html"><span class="header-section-number">8</span> Probability</a></div>
<div class="next"><a href="t-tests.html"><span class="header-section-number">10</span> t-tests</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#correlation"><span class="header-section-number">9</span> Correlation</a></li>
<li><a class="nav-link" href="#correlation-1"><span class="header-section-number">9.1</span> Correlation</a></li>
<li><a class="nav-link" href="#corr-a1"><span class="header-section-number">9.2</span> Activity 1: Set-up</a></li>
<li><a class="nav-link" href="#corr-a2"><span class="header-section-number">9.3</span> Activity 2: Look at your data</a></li>
<li>
<a class="nav-link" href="#corr-a3"><span class="header-section-number">9.4</span> Activity 3: Assumptions</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#assumption-1-level-of-measurement"><span class="header-section-number">9.4.1</span> Assumption 1: Level of Measurement</a></li>
<li><a class="nav-link" href="#assumption-2-pairs-of-data"><span class="header-section-number">9.4.2</span> Assumption 2: Pairs of Data</a></li>
<li><a class="nav-link" href="#assumption-3-5-normality-linearity-homoscedasticity"><span class="header-section-number">9.4.3</span> Assumption 3-5: Normality, linearity, homoscedasticity</a></li>
</ul>
</li>
<li><a class="nav-link" href="#correlation-scatterplot"><span class="header-section-number">9.5</span> Correlation Scatterplot</a></li>
<li><a class="nav-link" href="#corr-a4"><span class="header-section-number">9.6</span> Activity 4: Descriptive statistics</a></li>
<li><a class="nav-link" href="#corr-a5"><span class="header-section-number">9.7</span> Activity 5: Run the correlation</a></li>
<li><a class="nav-link" href="#corr-a6"><span class="header-section-number">9.8</span> Activity 6: Interpreting the correlation</a></li>
<li><a class="nav-link" href="#corr-a7"><span class="header-section-number">9.9</span> Activity 7: Write-up</a></li>
<li><a class="nav-link" href="#corr-a8"><span class="header-section-number">9.10</span> Activity 8: Scatterplot matrix</a></li>
<li><a class="nav-link" href="#corr-a9"><span class="header-section-number">9.11</span> Activity 9: Multiple correlations</a></li>
<li><a class="nav-link" href="#corr-fin"><span class="header-section-number">9.12</span> Finished!</a></li>
<li>
<a class="nav-link" href="#corr-sols"><span class="header-section-number">9.13</span> Activity solutions</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#corr-a1sol"><span class="header-section-number">9.13.1</span> Activity 1</a></li>
<li><a class="nav-link" href="#corr-a3sol"><span class="header-section-number">9.13.2</span> Activity 3</a></li>
<li><a class="nav-link" href="#corr-a4sol"><span class="header-section-number">9.13.3</span> Activity 4</a></li>
<li><a class="nav-link" href="#corr-a5sol"><span class="header-section-number">9.13.4</span> Activity 5</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/PsyTeachR/quant-fun-v2/blob/master/book/09-correlation.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/PsyTeachR/quant-fun-v2/edit/master/book/09-correlation.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Fundamentals of Quantitative Analysis</strong>" was written by Emily Nordmann &amp; Phil McAleer. It was last built on 2021-09-22.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
