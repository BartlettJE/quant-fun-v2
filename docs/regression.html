<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>Chapter 16 Regression | Fundamentals of Quantitative Analysis</title>

    <meta name="author" content="Emily Nordmann &amp; Phil McAleer" />
  
   <meta name="description" content="This book is designed for Masters Level students who have no prior training in data skills and/or statistical analysis." />
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="Chapter 16 Regression | Fundamentals of Quantitative Analysis" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://psyteachr.github.io/quant-fun-v2" />
  <meta property="og:image" content="https://psyteachr.github.io/quant-fun-v2/images/logos/logo.png" />
  <meta property="og:description" content="This book is designed for Masters Level students who have no prior training in data skills and/or statistical analysis." />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 16 Regression | Fundamentals of Quantitative Analysis" />
  
  <meta name="twitter:description" content="This book is designed for Masters Level students who have no prior training in data skills and/or statistical analysis." />
  <meta name="twitter:image" content="https://psyteachr.github.io/quant-fun-v2/images/logos/logo.png" />
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/header-attrs-2.11/header-attrs.js"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.3.1/transition.js"></script>
    <script src="libs/bs3compat-0.3.1/tabs.js"></script>
    <script src="libs/bs3compat-0.3.1/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-6NP3MF25W3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-6NP3MF25W3');
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
    <link rel="stylesheet" href="include/psyteachr.css" />
    <link rel="stylesheet" href="include/webex.css" />
    <link rel="stylesheet" href="include/style.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Fundamentals of Quantitative Analysis</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<div id="regression" class="section level1" number="16">
<h1><span class="header-section-number">Chapter 16</span> Regression</h1>
<p>In this activity, you will be working with real data and using regression to explore the question of whether there is a relationship between statistics anxiety and engagement in course activities. The hypothesis is that students who are more anxious about statistics are less likely to engage in course-related activities.</p>
<p>We are going to analyse data from the STARS Statistics Anxiety Survey, which was administered to students in the third-year statistics course in Psychology at the University of Glasgow. All the responses have been anonymised by associating the responses for each student with an arbitrary ID number (integer).</p>
<p>The STARS survey (Cruise, Cash, &amp; Bolton, 1985) is a 51-item questionnaire, with each response on a 1 to 5 scale, with higher numbers indicating greater anxiety.</p>
<p>Cruise, R. J., Cash, R. W., &amp; Bolton, D. L. (1985). Development and validation of an instrument to measure statistical anxiety. <em>Proceedings of the American Statistical Association, Section on Statistical Education</em>, Las Vegas, NV.</p>
<div class="figure">
<img src="images/stars_survey.png" alt="" />
<p class="caption"><em>Example items from the STARS survey (Cruise, Cash, &amp; Bolton, 1985)</em></p>
</div>
<p>As a measure of engagement in the course, we will use data from Moodle usage analytics. Over the course of the term, there were eight optional weekly on-line sessions that students could attend for extra support. The variable <code>n_weeks</code> in the <code>psess.csv</code> file tells you how many (out of eight) a given student attended.</p>
<p>Our hypothesis was that greater anxiety would be reflected in lower engagement. Answer the following question.</p>
<p>If our hypothesis is correct then there should be <select class='webex-select'><option value='blank'></option><option value=''>a positive</option><option value=''>no</option><option value='answer'>a negative</option></select> correlation between students' mean anxiety levels and <code>n_weeks</code>.</p>
<div id="regression-a1" class="section level2" number="16.1">
<h2><span class="header-section-number">16.1</span> Activity 1: Setup</h2>
<ul>
<li>Open R Studio and set the working directory to your chapter folder. Ensure the environment is clear.<br />
</li>
<li>Open a new R Markdown document and save it in your working directory. Call the file "Regression".<br />
</li>
<li>Download <a href="L3_stars.csv" download>L3_stars.csv</a> and <a href="psess.csv" download>psess.csv</a> and save them in your chapter folder. Make sure that you do not change the file name at all.<br />
</li>
<li>If you're on the server, avoid a number of issues by restarting the session - click <code>Session</code> - <code>Restart R</code></li>
<li>Delete the default R Markdown welcome text and insert a new code chunk that loads <code>pwr</code>, <code>broom</code>, <code>see</code>, <code>performance</code>, <code>report</code> and <code>tidyverse</code> using the <code>library()</code> function.</li>
<li>Load the two CSV datasets into variables called <code>stars</code> and <code>engage</code> using <code>read_csv()</code>.</li>
</ul>
</div>
<div id="regression-a2" class="section level2" number="16.2">
<h2><span class="header-section-number">16.2</span> Activity 2: Tidy the data</h2>
<ul>
<li>Take a look at both of the datasets you loaded in.</li>
</ul>
<p>The next thing we need to do is to calculate a mean anxiety score for each student (recall that individual students are identified by the <code>ID</code> variable).</p>
<p>Recall the difference between <em>wide</em> and <em>tidy</em> data. In wide data, each row represents an individual case, with observations for that case in separate columns; in tidy data, each row represents a single observation, and the observations are grouped together into cases based on the value of a variable (for these data, the <code>ID</code> variable).</p>
<ul>
<li>The STARS data are currently in <select class='webex-select'><option value='blank'></option><option value='answer'>wide</option><option value=''>tidy</option></select> format.</li>
</ul>
<p>Before we calculate means, you need to use <code>pivot_longer()</code> to restructure the STARS data into the appropriate "tidy" format; i.e., so that it looks like the table below.</p>
<table>
<thead>
<tr class="header">
<th align="center">ID</th>
<th align="center">Question</th>
<th align="center">Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">3</td>
<td align="center">Q01</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">3</td>
<td align="center">Q02</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">Q03</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">3</td>
<td align="center">Q04</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">Q05</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">3</td>
<td align="center">Q06</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<ul>
<li>Write and run the code to do tidy the STARS data, and store the resulting table as <code>stars2</code>.</li>
</ul>
</div>
<div id="regression-a3" class="section level2" number="16.3">
<h2><span class="header-section-number">16.3</span> Activity 3: Calculate mean anxiety for each student</h2>
<ul>
<li>Now that you've got the data into a tidy format, use <code>summarise()</code> and <code>group_by()</code> to calculate mean anxiety scores (<code>mean_anxiety</code>) for each student (<code>ID</code>). Store the resulting table in a variable named <code>stars_means</code>.</li>
</ul>
</div>
<div id="regression-a4" class="section level2" number="16.4">
<h2><span class="header-section-number">16.4</span> Activity 4: Join the datasets together</h2>
<ul>
<li>In order to perform the regression analysis, combine the data from <code>stars_means</code> with <code>engage</code> using <code>inner_join()</code>. Call the resulting table <code>joined</code>. It should look like this:</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="center">ID</th>
<th align="center">mean_anxiety</th>
<th align="center">n_weeks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">3</td>
<td align="center">1.06</td>
<td align="center">5</td>
</tr>
<tr class="even">
<td align="center">7</td>
<td align="center">2.71</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="center">12</td>
<td align="center">2.24</td>
<td align="center">3</td>
</tr>
<tr class="even">
<td align="center">16</td>
<td align="center">2.86</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="center">23</td>
<td align="center">1.71</td>
<td align="center">6</td>
</tr>
<tr class="even">
<td align="center">29</td>
<td align="center">1.80</td>
<td align="center">7</td>
</tr>
</tbody>
</table>
</div>
<div id="regression-a5" class="section level2" number="16.5">
<h2><span class="header-section-number">16.5</span> Activity 5: Calculate descriptives for the variables overall</h2>
<p>It is also useful to calculate descriptives statistics for the sample overall so that you can check that the sample scores are what you were expecting (e.g., are they comparable to previous studies and samples?). This is also useful for the write-up.</p>
<ul>
<li>Run the below code. Read each line and ensure you understand what is being calculated.</li>
</ul>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="regression.html#cb322-1" aria-hidden="true" tabindex="-1"></a>descriptives <span class="ot">&lt;-</span> joined <span class="sc">%&gt;%</span></span>
<span id="cb322-2"><a href="regression.html#cb322-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_anx =</span> <span class="fu">mean</span>(mean_anxiety, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb322-3"><a href="regression.html#cb322-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_anx =</span> <span class="fu">sd</span>(mean_anxiety, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb322-4"><a href="regression.html#cb322-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_weeks =</span> <span class="fu">mean</span>(n_weeks, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb322-5"><a href="regression.html#cb322-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_weeks =</span> <span class="fu">sd</span>(n_weeks, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
</div>
<div id="regression-a6" class="section level2" number="16.6">
<h2><span class="header-section-number">16.6</span> Activity 6: Visualisations</h2>
<ul>
<li>Now that you've have all of the variables in one place, write the code to reproduce the exact scatterplot below (using ggplot2).</li>
</ul>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:scatter"></span>
<img src="16-regression_files/figure-html/scatter-1.png" alt="Scatteplot of mean anxiety and attendance" width="100%" />
<p class="caption">
Figure 16.1: Scatteplot of mean anxiety and attendance
</p>
</div>
<ul>
<li>According to the scatterplot, <select class='webex-select'><option value='blank'></option><option value=''>there is no apparent relationship</option><option value='answer'>as anxiety increases, engagement decreases</option><option value=''>as anxiety increases, engagement increases</option></select></li>
</ul>
</div>
<div id="regression-a7" class="section level2" number="16.7">
<h2><span class="header-section-number">16.7</span> Activity 7: Run the regression</h2>
<p>The <code>lm()</code> function from Base R is the main function to estimate a <em>L</em>inear <em>M</em>odel (hence the function name <code>lm</code>). <code>lm()</code> uses formula syntax that you have seen before, i.e., <code>DV ~ predictor</code>.</p>
<ul>
<li>Use the <code>lm()</code> function to predict <code>n_weeks</code> (DV) from <code>mean_anxiety</code> (predictor). Store the result of the call to <code>lm()</code> in the variable <code>mod</code>. To see the results, use <code>summary(mod)</code>.</li>
</ul>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="regression.html#cb323-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(n_weeks <span class="sc">~</span> mean_anxiety, joined)</span>
<span id="cb323-2"><a href="regression.html#cb323-2" aria-hidden="true" tabindex="-1"></a>mod_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(mod)</span></code></pre></div>
<p>Answer the following questions about the model. You may wish to refer to the lecture notes to help you answer these questions.</p>
<ol style="list-style-type: decimal">
<li>The estimate of the y-intercept for the model, rounded to three decimal places, is <input class='webex-solveme nospaces' size='5' data-answer='["9.057"]'/></li>
<li>To three decimal places, if the GLM for this model is <span class="math inline">\(Y_i = \beta_0 + \beta_1 X_i + e_i\)</span>, then <span class="math inline">\(\beta_1\)</span> is <input class='webex-solveme nospaces' size='6' data-answer='["-2.173"]'/></li>
<li>To three decimal places, for each unit increase in anxiety, <code>n_weeks</code> decreases by <input class='webex-solveme nospaces' size='5' data-answer='["2.173"]'/></li>
<li>To two decimal places, what is the overall F-ratio of the model? <input class='webex-solveme nospaces' size='5' data-answer='["11.99"]'/></li>
<li>Is the overall model significant? <select class='webex-select'><option value='blank'></option><option value='answer'>Yes</option><option value=''>No</option></select></li>
<li>What proportion of the variance does the model explain? <input class='webex-solveme nospaces' size='5' data-answer='["23.39"]'/></li>
</ol>
<div class="webex-solution">
<button>
Explain these answers
</button>
<ol style="list-style-type: decimal">
<li>In the summary table, this is the estimate of the intercept.</li>
<li>In the summary table, this is the estimate of mean_anxiety, i.e., the slope.</li>
<li>In the summary table, this is also the estimate of mean_anxiety, the slope is how much it decreases so you just remove the - sign.</li>
<li>In the summary table, the F-ratio is noted as he F-statistic.</li>
<li>The overall model p.value is .001428 which is less than .05, therefore significant.</li>
<li>The variance explained is determined by R-squared, you simply multiple it by 100 to get the percent. You should always use the adjusted R-squared value.</li>
</ol>
</div>
<p><br></p>
</div>
<div id="regression-a8" class="section level2" number="16.8">
<h2><span class="header-section-number">16.8</span> Activity 8: Assumption checking</h2>
<p>Just like with ANOVA, you can't check the assumptions until you've run the regression so now we'll do that to check whether there's anything to be concerned about. As we covered in the lecture, the assumptions for regression are a little bit more involved than they were for ANOVA.</p>
<ol style="list-style-type: decimal">
<li>The outcome/DV is a interval/ratio level data</li>
<li>The predictor variable is interval/ratio or categorical (with two levels)</li>
<li>All values of the outcome variable are independent (i.e., each score should come from a different participant)</li>
<li>The predictors have non-zero variance</li>
<li>The relationship between outcome and predictor is linear</li>
<li>The residuals should be normally distributed</li>
<li>There should be homoscedasticity (homogeneity of variance, but for the residuals)</li>
</ol>
<p>Assumptions 1-3 are nice and easy. We know this from the data we have and the design of the study. Assumption 4 simply means that there is some spread in the data - for example, there's no point running a regression with age as a variable if all your participants are 20 years old. We can check this using the scatterplot we created in Activity 4 and we can see that this assumption is met, we do indeed have a spread of scores.</p>
<p>For the rest of the assumptions, we're going to use functions from the packages <code>see</code> and <code>performance</code> that make life a whole lot easier.</p>
<p>First, we can use <code>check_model()</code> to produce a range of assumption test visualisations. Helpfully, this function also provides a brief explanation of what you should be looking for in each plot - if only all functions in R were so helpful!</p>
<ul>
<li><p>If you get the error message <code>Failed with error:  ‘there is no package called ‘qqplotr’’</code>, install the package <code>qqplotr</code>, you don't need to load it using <code>library()</code>, but <code>check_model()</code> uses it in the background.</p></li>
<li><p>If your <code>check_model()</code> plots are not showing, try maximising your plot window.</p></li>
</ul>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="regression.html#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(mod)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="16-regression_files/figure-html/check_model-1.png" alt="Visual assumption checks" width="100%" />
<p class="caption">
(#fig:check_model)Visual assumption checks
</p>
</div>
<p>For Assumption 5, linearity, the plot suggests it's not perfect but it looks pretty good.</p>
<p>As we've already noted, it's good to visualise your assumption checks because just relying on statistics can be problematic, as they can be sensitive to small or large sample sizes. However, it can also be reassuring to have a statistical test to back up your intuitions from the plot.</p>
<p>For Assumption 6, normality of residuals, the plot does suggest that the residuals might not be normal, so we can check this with <code>check_normality()</code> which runs a Shapiro-Wilk test.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="regression.html#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_normality</span>(mod)</span></code></pre></div>
<pre><code>## Warning: Non-normality of residuals detected (p = 0.008).</code></pre>
<p>The result confirms that the residuals are not normally distributed, something that is likely being exacerbated by the relatively small sample size. If you're feeling confident, you can see how we might resolve this below, but for the core aims of this chapter we'll conclude that it's because of the sample and continue.</p>
<div class="webex-solution">
<button>
Transforming the data to correct for non-normality
</button>
<p>There are multiple ways you can transform data to deal with non-normality, you can find more information about data transformation in the <a href="https://psyteachr.github.io/msc-conv/data-transformation.html">Appendix here</a>.</p>
<p>First, we need to get a sense of what the issue is with our dependent variable, in this case <code>n_weeks</code>. A simple histogram shows that the DV isn't a normal distribution, instead, it looks more like a <a href="https://openstax.org/books/introductory-statistics/pages/5-2-the-uniform-distribution">uniform distribution</a>.</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="regression.html#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(joined, <span class="fu">aes</span>(<span class="at">x =</span> n_weeks)) <span class="sc">+</span></span>
<span id="cb327-2"><a href="regression.html#cb327-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="16-regression_files/figure-html/unnamed-chunk-2-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>It's important to remember that the assumptions of regression are that the residuals are normally distributed, not the raw data, however, transforming the DV can help.</p>
<p>To transform the uniform distribution to a normal distribution, we're going to use the <code>unif2norm</code> function from the <code>faux</code> package (which you may need to install).</p>
<p>This code uses <code>mutate()</code> to create a new variable <code>n_weeks_transformed</code> that is the result of the transformation.</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="regression.html#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(faux)</span>
<span id="cb328-2"><a href="regression.html#cb328-2" aria-hidden="true" tabindex="-1"></a>joined <span class="ot">&lt;-</span> <span class="fu">mutate</span>(joined, </span>
<span id="cb328-3"><a href="regression.html#cb328-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">n_weeks_transformed =</span> <span class="fu">unif2norm</span>(n_weeks))</span>
<span id="cb328-4"><a href="regression.html#cb328-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-5"><a href="regression.html#cb328-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(joined, <span class="fu">aes</span>(<span class="at">x =</span> n_weeks_transformed)) <span class="sc">+</span></span>
<span id="cb328-6"><a href="regression.html#cb328-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code></pre></div>
<p><img src="16-regression_files/figure-html/unnamed-chunk-3-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>You'll notice that the histogram for the transformed variable still doesn't look amazing, but remember it's the residuals, not the raw data that matters. If we re-run the regression with the transformed data and then check the model again, things are looking much better.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="regression.html#cb329-1" aria-hidden="true" tabindex="-1"></a>mod_transformed <span class="ot">&lt;-</span> <span class="fu">lm</span>(n_weeks_transformed <span class="sc">~</span> mean_anxiety, joined)</span>
<span id="cb329-2"><a href="regression.html#cb329-2" aria-hidden="true" tabindex="-1"></a><span class="fu">check_normality</span>(mod_transformed)</span>
<span id="cb329-3"><a href="regression.html#cb329-3" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(mod_transformed)</span></code></pre></div>
<p><img src="16-regression_files/figure-html/unnamed-chunk-4-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre><code>## OK: residuals appear as normally distributed (p = 0.107).</code></pre>
<p>It's worth saying at this point that which transformation you use, and whether it works, can be a bit of trial-and-error.</p>
</div>
<p><br></p>
<p>For homoscedasticity, the plot looks mostly fine, but we can double check this with <code>check_heteroscedasticity()</code> and the result confirms that the data have met this assumption.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="regression.html#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_heteroscedasticity</span>(mod)</span></code></pre></div>
<pre><code>## OK: Error variance appears to be homoscedastic (p = 0.542).</code></pre>
</div>
<div id="regression-a9" class="section level2" number="16.9">
<h2><span class="header-section-number">16.9</span> Activity 9: Power and effect size</h2>
<p>First we can calculate the minimum effect size we were able to detect given the sample size and design of the study using <code>pwr.f2.test()</code>. As usual, we fill in all the information we have and set the effect size argument, in this case <code>f2</code>, to <code>NULL</code>.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="regression.html#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwr.f2.test</span>(<span class="at">u =</span> <span class="dv">1</span>, <span class="at">v =</span> <span class="dv">35</span>, <span class="at">f2 =</span> <span class="cn">NULL</span>, <span class="at">sig.level =</span> .<span class="dv">05</span>, <span class="at">power =</span> .<span class="dv">8</span>)</span></code></pre></div>
<div class="webex-solution">
<button>
Explain the pwr.f2.test function
</button>
<p><strong>u</strong> - Numerator degrees of freedom. This the number of coefficients you have in your model (minus the intercept)
<strong>v</strong> - Denominator degrees of freedom. This is calculated as v=n-u-1, where n is the number of participants
<strong>f2</strong> - The effect size - here we are solving the effect size, so this parameter is left as NULL
<strong>sig.level</strong> - The significance level of your study
<strong>power</strong> - The power level of your study</p>
</div>
<p><br></p>
<ul>
<li>Based on the power analysis, what is the minimum effect size we were able to detect rounded to 2 decimal places? <input class='webex-solveme nospaces' size='0.22' data-answer='[".22"]'/><br />
</li>
<li>According to Cohen's guidelines, this would be a <select class='webex-select'><option value='blank'></option><option value=''>Small</option><option value='answer'>Medium</option><option value=''>Large</option></select> effect.</li>
</ul>
<p>There is no formula to calculate our observed f<sup>2</sup>, we must do it manually using the formula from the lecture.</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="regression.html#cb334-1" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> mod_summary<span class="sc">$</span>adj.r.squared<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> mod_summary<span class="sc">$</span>adj.r.squared)</span></code></pre></div>
<ul>
<li>Is the observed effect size larger than the minimum effect size we could detect? <select class='webex-select'><option value='blank'></option><option value='answer'>Yes, our study is sufficiently powered</option><option value=''>No, our study is underpowered</option></select></li>
</ul>
</div>
<div id="regression-a10" class="section level2" number="16.10">
<h2><span class="header-section-number">16.10</span> Activity 10: Write-up</h2>
<p>There's two ways we can use R to help with the write-up. The first is inline coding like we've done in the other chapters, and the second is to use the <code>report</code> package. Which one you use is entirely up to you but it's nice to have options.</p>
<p>We need to manually calculate the p-value for the inline coding as you can't extract it from the <code>lm()</code> model. Run the below code to do this.</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="regression.html#cb335-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span>mod_summary<span class="sc">$</span>fstatistic</span>
<span id="cb335-2"><a href="regression.html#cb335-2" aria-hidden="true" tabindex="-1"></a>mod_p <span class="ot">&lt;-</span> <span class="fu">pf</span>(f[<span class="dv">1</span>], f[<span class="dv">2</span>], f[<span class="dv">3</span>], <span class="at">lower=</span><span class="cn">FALSE</span>) </span></code></pre></div>
<p>Now, copy and paste the below code into <strong>white-space</strong> and knit the document.</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="regression.html#cb336-1" aria-hidden="true" tabindex="-1"></a>A simple linear regression was performed with <span class="fu">engagement</span> (<span class="at">M =</span> <span class="st">`</span><span class="at">r descriptives$mean_weeks %&gt;% round(2)</span><span class="st">`</span>, <span class="at">SD =</span> <span class="st">`</span><span class="at">r descriptives$sd_anx %&gt;% round(2)</span><span class="st">`</span>) as the outcome variable and statistics <span class="fu">anxiety</span> (<span class="at">M =</span> <span class="st">`</span><span class="at">r descriptives$mean_anx %&gt;% round(2)</span><span class="st">`</span>, <span class="at">SD =</span> <span class="st">`</span><span class="at">r descriptives$sd_anx %&gt;% round(2)</span><span class="st">`</span>) as the predictor variable. The results of the regression indicated that the model significantly predicted course <span class="fu">engagement</span> (<span class="fu">F</span>(<span class="st">`</span><span class="at">r mod_summary$fstatistic[2]</span><span class="st">`</span>, <span class="st">`</span><span class="at">r mod_summary$fstatistic[3]</span><span class="st">`</span>) <span class="ot">=</span> <span class="st">`</span><span class="at">r mod_summary$fstatistic[1] %&gt;% round(2)</span><span class="st">`</span>, p <span class="sc">&lt;</span> .<span class="dv">001</span>, Adjusted <span class="at">R2 =</span> <span class="st">`</span><span class="at">r mod_summary$adj.r.squared %&gt;% round(2)</span><span class="st">`</span>, <span class="at">f2 =</span> .<span class="dv">63</span>), accounting <span class="cf">for</span> <span class="st">`</span><span class="at">r (mod_summary$adj.r.squared %&gt;% round(2))*100</span><span class="st">`</span><span class="sc">% of the variance. Anxiety was a significant predictor (β = `r mod$coefficients[2] %</span><span class="er">&gt;</span><span class="sc">% round(2)`, p &lt; `r mod_p %</span><span class="er">&gt;</span>% <span class="fu">round</span>(<span class="dv">3</span>)<span class="st">`</span><span class="at">.</span></span>
<span id="cb336-2"><a href="regression.html#cb336-2" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span></code></pre></div>
<p>A simple linear regression was performed with engagement (M = 4.54, SD = 0.56) as the outcome variable and statistics anxiety (M = 2.08, SD = 0.56) as the predictor variable. The results of the regression indicated that the model significantly predicted course engagement (F(1, 35) = 11.99, p &lt; .001, Adjusted R2 = 0.23, f<sup>2</sup> = .63), accounting for 23% of the variance. Anxiety was a significant predictor (β = -2.17, p &lt; 0.001.
)</p>
<p>The second option uses <code>report</code>. Just like with the t-test, the output of these functions doesn't tend to be useable without some editing but particularly when you're first learning how to write-up stats it can be useful to have this kind of template (and also to see that there's different ways of reporting stats).</p>
<p>Running <code>report()</code> will output a summary of the results which you could copy and past into your Word document.</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="regression.html#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(mod)</span></code></pre></div>
<pre><code>## We fitted a linear model (estimated using OLS) to predict n_weeks with mean_anxiety (formula: n_weeks ~ mean_anxiety). The model explains a statistically significant and moderate proportion of variance (R2 = 0.26, F(1, 35) = 11.99, p = 0.001, adj. R2 = 0.23). The model&#39;s intercept, corresponding to mean_anxiety = 0, is at 9.06 (95% CI [6.32, 11.80], t(35) = 6.71, p &lt; .001). Within this model:
## 
##   - The effect of mean anxiety is statistically significant and negative (beta = -2.17, 95% CI [-3.45, -0.90], t(35) = -3.46, p = 0.001; Std. beta = -0.51, 95% CI [-0.80, -0.21])
## 
## Standardized parameters were obtained by fitting the model on a standardized version of the dataset. 95% Confidence Intervals (CIs) and p-values were computed using the Wald approximation.</code></pre>
</div>
<div id="regression-sols" class="section level2" number="16.11">
<h2><span class="header-section-number">16.11</span> Activity solutions</h2>
<div id="regression-a1sol" class="section level3" number="16.11.1">
<h3><span class="header-section-number">16.11.1</span> Activity 1</h3>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="regression.html#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;pwr&quot;</span>)</span>
<span id="cb339-2"><a href="regression.html#cb339-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;broom&quot;</span>)</span>
<span id="cb339-3"><a href="regression.html#cb339-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;see&quot;</span>)</span>
<span id="cb339-4"><a href="regression.html#cb339-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;performance&quot;</span>)</span>
<span id="cb339-5"><a href="regression.html#cb339-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;report&quot;</span>)</span>
<span id="cb339-6"><a href="regression.html#cb339-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb339-7"><a href="regression.html#cb339-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-8"><a href="regression.html#cb339-8" aria-hidden="true" tabindex="-1"></a>stars <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;L3_stars.csv&quot;</span>)</span>
<span id="cb339-9"><a href="regression.html#cb339-9" aria-hidden="true" tabindex="-1"></a>engage <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;psess.csv&quot;</span>)</span></code></pre></div>
</div>
<p>** Click tab to see solution **</p>
</div>
<div id="regression-a2sol" class="section level3" number="16.11.2">
<h3><span class="header-section-number">16.11.2</span> Activity 2</h3>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="regression.html#cb340-1" aria-hidden="true" tabindex="-1"></a>stars2 <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(<span class="at">data =</span> stars, <span class="at">names_to =</span> <span class="st">&quot;Question&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Score&quot;</span>,<span class="at">cols =</span> Q01<span class="sc">:</span>Q51) <span class="sc">%&gt;%</span></span>
<span id="cb340-2"><a href="regression.html#cb340-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(ID)</span></code></pre></div>
</div>
<p>** Click tab to see solution **</p>
</div>
<div id="regression-a3sol" class="section level3" number="16.11.3">
<h3><span class="header-section-number">16.11.3</span> Activity 3</h3>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="regression.html#cb341-1" aria-hidden="true" tabindex="-1"></a>stars_means <span class="ot">&lt;-</span> stars2 <span class="sc">%&gt;%</span></span>
<span id="cb341-2"><a href="regression.html#cb341-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb341-3"><a href="regression.html#cb341-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_anxiety =</span> <span class="fu">mean</span>(Score, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb341-4"><a href="regression.html#cb341-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">min =</span> <span class="fu">min</span>(Score), </span>
<span id="cb341-5"><a href="regression.html#cb341-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">max =</span> <span class="fu">min</span>(Score),</span>
<span id="cb341-6"><a href="regression.html#cb341-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(Score))</span></code></pre></div>
</div>
<p>** Click tab to see solution **</p>
</div>
<div id="regression-a4sol" class="section level3" number="16.11.4">
<h3><span class="header-section-number">16.11.4</span> Activity 4</h3>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="regression.html#cb342-1" aria-hidden="true" tabindex="-1"></a>joined <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(stars_means, engage, <span class="st">&quot;ID&quot;</span>)</span></code></pre></div>
</div>
<p>** Click tab to see solution **</p>
</div>
<div id="regression-a6sol" class="section level3" number="16.11.5">
<h3><span class="header-section-number">16.11.5</span> Activity 6</h3>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="regression.html#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(joined, <span class="fu">aes</span>(mean_anxiety, n_weeks)) <span class="sc">+</span></span>
<span id="cb343-2"><a href="regression.html#cb343-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb343-3"><a href="regression.html#cb343-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>)<span class="sc">+</span></span>
<span id="cb343-4"><a href="regression.html#cb343-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
</div>
<p>** Click tab to see solution **</p>

</div>
</div>
</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script>
<script>
$( document ).ready(function() {
  var cite = ' ';
  var psyteachr = ' <a href="https://psyteachr.github.io/"><img src="images/logos/psyteachr_logo.png" style="height: 31px; color: white;" alt="psyTeachR: Reproducible Research" /></a>';
  var license = ' <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" target="blank"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a>';

  $("footer div.row div:eq(1) p").html(
    psyteachr + license + cite
  );
  
  // open rdrr links externally
  $("a[href^='https://rdrr.io']").click(function(){
    window.open(this.href);
    return false;
  });
  
  // visible second sidebar in mobile
  function move_sidebar() {
    var w = window.innerWidth;
    if (w < 992) {
      $("#toc").appendTo($("#main-nav"));
    } else {
      $("#toc").appendTo($("div.sidebar-chapter"));
    }
  }
  move_sidebar();
  window.onresize = move_sidebar;
});
</script>
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Fundamentals of Quantitative Analysis</strong>" was written by Emily Nordmann &amp; Phil McAleer. It was last built on 2022-12-19.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
<script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>

</html>
